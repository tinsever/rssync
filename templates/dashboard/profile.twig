{% extends 'layout/dashboard.twig' %}

{% block title %}Profil - {{ app_name }}{% endblock %}

{% block dashboard_content %}
<h4>Profil</h4>

<div class="row">
    <div class="col s12 m6">
        <div class="card">
            <div class="card-content">
                <span class="card-title">Kontoinformationen</span>
                
                <div class="input-field">
                    <i class="material-icons prefix">email</i>
                    <input type="email" id="email" value="{{ user.email }}" disabled>
                    <label for="email" class="active">E-Mail-Adresse</label>
                </div>
                
                {% if workosUser %}
                    {% if workosUser.firstName or workosUser.lastName %}
                    <div class="input-field">
                        <i class="material-icons prefix">person</i>
                        <input type="text" value="{{ workosUser.firstName }} {{ workosUser.lastName }}" disabled>
                        <label class="active">Name</label>
                    </div>
                    {% endif %}
                    
                    {% if workosUser.id %}
                    <div class="input-field">
                        <i class="material-icons prefix">fingerprint</i>
                        <input type="text" value="{{ workosUser.id }}" disabled>
                        <label class="active">WorkOS Benutzer-ID</label>
                    </div>
                    {% endif %}
                {% endif %}
                
                {% if user.email_verified_at %}
                    <p class="green-text">
                        <i class="material-icons tiny">check_circle</i> E-Mail verifiziert
                    </p>
                {% else %}
                    <p class="orange-text">
                        <i class="material-icons tiny">warning</i> E-Mail nicht verifiziert
                    </p>
                {% endif %}
                
                <div style="margin-top: 1.5rem;">
                    <a href="{{ url_for('dashboard.profile.refresh') }}" class="btn waves-effect waves-light blue">
                        <i class="material-icons left">refresh</i>Profil aktualisieren
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col s12 m6">
        <div class="card">
            <div class="card-content">
                <span class="card-title">WorkOS-Verwaltung</span>
                
                <p class="grey-text text-darken-2">
                    Ihre Profiländerungen (E-Mail, Passwort, Name) werden über WorkOS verwaltet.
                </p>
                
                <div class="card-panel blue lighten-5" style="margin-top: 1rem;">
                    <p class="grey-text text-darken-2">
                        <i class="material-icons tiny">info</i>
                        Klicken Sie auf den Button unten, um zur WorkOS-Verwaltungsoberfläche zu gelangen,
                        wo Sie Ihre Kontodaten ändern können.
                    </p>
                </div>
                
                <div style="margin-top: 1.5rem;">
                    <a href="{{ url_for('dashboard.profile.workos') }}" class="btn waves-effect waves-light orange">
                        <i class="material-icons left">settings</i>WorkOS-Verwaltung öffnen
                    </a>
                    <p class="grey-text text-darken-1" style="margin-top: 0.5rem; font-size: 0.85rem;">
                        Sie werden zu WorkOS weitergeleitet, um Ihre Kontodaten zu ändern.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card red lighten-5" style="margin-top: 1rem;">
    <div class="card-content">
        <span class="card-title red-text">Konto löschen</span>
        <p class="grey-text text-darken-2">
            Diese Aktion kann nicht rückgängig gemacht werden. Alle Ihre Kategorien, Quellen und Listen werden gelöscht.
        </p>
        
        <form action="{{ url_for('dashboard.profile.delete') }}" method="POST" onsubmit="return confirm('Sind Sie sicher? Alle Ihre Daten werden unwiderruflich gelöscht!');">
            <button type="submit" class="btn waves-effect waves-light red" style="margin-top: 1rem;">
                <i class="material-icons left">delete_forever</i>Konto löschen
            </button>
        </form>
    </div>
</div>
{% endblock %}
